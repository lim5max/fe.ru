<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Домены - FE Платформа</title>
  <link href="../styles.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
    rel="stylesheet"
  />
  <!-- Grid.js CSS / Стили Grid.js -->
  <link href="https://unpkg.com/gridjs/dist/theme/mermaid.min.css" rel="stylesheet">
  <!-- Grid.js JavaScript -->
  <script src="https://unpkg.com/gridjs/dist/gridjs.umd.js"></script>
  <!-- Header Web Component -->
  <script src="../components/fe-header.js"></script>
</head>
<body class="bg-base-surface-1 font-sans">

  <!-- Main Container / Главный контейнер -->
  <div class="min-h-screen flex">
    <!-- Sidebar / Боковая панель -->
    <div id="sidebar-container" class="hidden lg:block"></div>

    <!-- Main Content Area / Основная область контента -->
    <div class="flex flex-col grow w-full">
      <!-- Header / Заголовок -->
      <fe-header></fe-header>

      <!-- Page Content / Содержимое страницы -->
      <div class="bg-base-surface-1 flex flex-col gap-2.5 grow pt-14 px-15 w-full lg:pl-[300px]">
          <div class="basis-0 content-stretch flex flex-col gap-6 grow items-center justify-start max-h-[850px] min-h-px min-w-px relative shrink-0 w-full">

            <!-- Page Header Section / Секция заголовка страницы -->
            <div class="content-stretch flex flex-col gap-3 items-center justify-start relative shrink-0 w-full">
              <div class="content-stretch flex flex-col md:flex-row md:items-center md:justify-between relative shrink-0 w-full gap-4 md:gap-0">
                <div class="flex items-center gap-4">
                  <h1 class="text-4xl-semibold text-text-dark-primary">Домены</h1>
                </div>
                <button class="bg-state-brand-active hover:bg-state-brand-hover active:bg-state-brand-active transition-colors rounded-6 px-4 h-15 flex items-center gap-2 justify-center w-full md:w-auto md:self-auto">
                  <img src="../public/icons/shopping-cart.svg" alt="Заказать" class="w-6 h-6 brightness-0 invert" />
                  <span class="text-lg-semibold text-text-light-primary">Заказать новый</span>
                </button>
              </div>
            </div>

            <!-- Search and Table Container / Контейнер поиска и таблицы -->
            <div class="content-stretch flex flex-col gap-4 items-start justify-start relative shrink-0 w-full">
              <!-- Search Bar / Строка поиска -->
              <div class="w-full max-w-md">
                <div class="relative">
                  <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                    <img src="../public/icons/search.svg" alt="Поиск" class="h-6 w-6" />
                  </div>
                  <input
                    type="text"
                    id="domain-search"
                    placeholder="Поиск доменов"
                    class="input w-full pl-16"
                  />
                </div>
              </div>

              <!-- Domains Table / Таблица доменов -->
              <!-- Desktop Table / Десктопная таблица -->
              <div id="domains-table" class="w-full hidden md:block"></div>

              <!-- Mobile Table / Мобильная таблица -->
              <div id="domains-table-mobile" class="block md:hidden w-full border border-base-border rounded-7 overflow-hidden">
                <!-- Mobile table content will be inserted here by JavaScript -->
              </div>

              <!-- Figma Pagination / Пагинация по дизайну Figma -->
              <!-- Desktop Version -->
              <div class="hidden md:flex bg-white content-stretch items-center justify-between relative shrink-0 w-full" style="margin-bottom: 82px;">
                <!-- Total Count / Общее количество -->
                <div class="content-stretch flex gap-2.5 items-center justify-start relative shrink-0">
                  <div class="flex flex-col font-['Inter_Variable:Medium',_sans-serif] justify-center leading-[0] not-italic relative shrink-0 text-sm text-text-dark-secondary text-nowrap">
                    <p class="leading-[22px] whitespace-pre">Всего 30 доменов</p>
                  </div>
                </div>

                <!-- Pagination Controls / Управление пагинацией -->
                <div class="absolute content-stretch flex gap-3 h-[36px] items-center justify-center left-1/2 top-1/2 translate-x-[-50%] translate-y-[-50%]">
                  <!-- Previous Button / Кнопка "Назад" -->
                  <div class="prev-button bg-base-fill-1 content-stretch flex flex-col items-center justify-center relative rounded-full shrink-0 size-[36px] cursor-pointer hover:bg-base-fill-2">
                    <div class="overflow-clip relative shrink-0 size-[12px]">
                      <img src="../public/icons/arrow-left.svg" alt="Назад" class="block max-w-none size-full" />
                    </div>
                  </div>

                  <!-- Page Numbers / Номера страниц -->
                  <div class="content-stretch flex gap-1 h-7 items-center justify-center relative shrink-0">
                    <!-- Page 1 (Active) / Страница 1 (Активная) -->
                    <div class="page-button bg-state-brand-active overflow-clip relative rounded-full shadow-[0.5px_0.5px_3px_0px_rgba(26,26,26,0.08)] shrink-0 size-[28px]" data-page="1">
                      <div class="absolute flex flex-col font-['Inter_Variable:SemiBold',_sans-serif] inset-0 justify-center leading-[0] not-italic text-sm text-center text-white">
                        <p class="leading-[22px]">1</p>
                      </div>
                    </div>

                    <!-- Page 2 / Страница 2 -->
                    <div class="page-button overflow-clip relative rounded-full shrink-0 size-[28px] cursor-pointer hover:bg-base-fill-1" data-page="2">
                      <div class="absolute flex flex-col font-['Inter_Variable:Medium',_sans-serif] inset-0 justify-center leading-[0] not-italic text-sm text-[rgba(26,26,26,0.36)] text-center">
                        <p class="leading-[22px]">2</p>
                      </div>
                    </div>

                    <!-- Page 3 / Страница 3 -->
                    <div class="page-button overflow-clip relative rounded-full shrink-0 size-[28px] cursor-pointer hover:bg-base-fill-1" data-page="3">
                      <div class="absolute flex flex-col font-['Inter_Variable:Medium',_sans-serif] inset-0 justify-center leading-[0] not-italic text-sm text-[rgba(26,26,26,0.36)] text-center">
                        <p class="leading-[22px]">3</p>
                      </div>
                    </div>

                    <!-- Page 4 / Страница 4 -->
                    <div class="page-button overflow-clip relative rounded-full shrink-0 size-[28px] cursor-pointer hover:bg-base-fill-1" data-page="4">
                      <div class="absolute flex flex-col font-['Inter_Variable:Medium',_sans-serif] inset-0 justify-center leading-[0] not-italic text-sm text-[rgba(26,26,26,0.36)] text-center">
                        <p class="leading-[22px]">4</p>
                      </div>
                    </div>

                    <!-- Ellipsis / Многоточие -->
                    <div class="overflow-clip relative rounded-full shrink-0 size-[28px]">
                      <div class="absolute flex flex-col font-['Inter_Variable:Medium',_sans-serif] inset-0 justify-center leading-[0] not-italic text-sm text-[rgba(26,26,26,0.36)] text-center">
                        <p class="leading-[22px]">...</p>
                      </div>
                    </div>

                    <!-- Page 10 / Страница 10 -->
                    <div class="page-button overflow-clip relative rounded-full shrink-0 size-[28px] cursor-pointer hover:bg-base-fill-1" data-page="10">
                      <div class="absolute flex flex-col font-['Inter_Variable:Medium',_sans-serif] inset-0 justify-center leading-[0] not-italic text-sm text-[rgba(26,26,26,0.36)] text-center">
                        <p class="leading-[22px]">10</p>
                      </div>
                    </div>
                  </div>

                  <!-- Next Button / Кнопка "Вперед" -->
                  <div class="next-button bg-[#fcfcfc] content-stretch flex flex-col items-center justify-center relative rounded-full shrink-0 size-[36px] border border-base-border cursor-pointer hover:bg-base-fill-1">
                    <div class="overflow-clip relative shrink-0 size-[12px]">
                      <img src="../public/icons/arrow-right.svg" alt="Вперед" class="block max-w-none size-full" />
                    </div>
                  </div>
                </div>

                <!-- Rows Per Page / Строк на странице -->
                <div class="content-stretch flex gap-2.5 items-center justify-end relative shrink-0">
                  <div class="flex flex-col font-['Inter_Variable:Medium',_sans-serif] justify-center leading-[0] not-italic relative shrink-0 text-sm text-text-dark-secondary text-nowrap">
                    <p class="leading-[22px] whitespace-pre">Показывать</p>
                  </div>

                  <!-- Dropdown for rows count / Выпадающий список количества строк -->
                  <div class="dropdown-container relative">
                    <div class="rows-dropdown-trigger bg-white box-border content-stretch flex gap-[6px] h-[36px] items-center justify-start min-h-[36px] pl-[12px] pr-[10px] py-0 relative rounded-full shrink-0 border border-base-border cursor-pointer hover:bg-base-fill-1">
                      <div class="flex flex-col font-['Inter_Variable:Medium',_sans-serif] justify-center leading-[0] not-italic relative shrink-0 text-sm text-text-dark-secondary text-nowrap">
                        <span id="rows-count-text" class="leading-[22px] whitespace-pre">8 строк</span>
                      </div>
                      <div class="overflow-clip relative shrink-0 size-[12px]">
                        <img src="../public/icons/arrow-down.svg" alt="Выпадающий список" class="block max-w-none size-full" />
                      </div>
                    </div>

                    <!-- Dropdown Menu -->
                    <div id="rows-dropdown-menu" class="dropdown-menu absolute bottom-full left-0 mb-1 bg-white border border-base-border rounded-xl shadow-lg z-50 min-w-[120px] hidden">
                      <div class="py-1">
                        <button class="dropdown-item w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="8">8 строк</button>
                        <button class="dropdown-item w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="16">16 строк</button>
                        <button class="dropdown-item w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="24">24 строки</button>
                        <button class="dropdown-item w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="32">32 строки</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Mobile Version / Мобильная версия -->
              <div class="flex md:hidden flex-col gap-4 bg-white relative shrink-0 w-full pb-8">
                <!-- Total Count / Общее количество -->
                <div class="flex items-center justify-center">
                  <p class="text-sm-medium text-text-dark-secondary">Всего 30 хостингов</p>
                </div>

                <!-- Pagination Controls / Управление пагинацией -->
                <div class="flex items-center justify-center gap-3">
                  <!-- Previous Button / Кнопка "Назад" -->
                  <div class="prev-button-mobile bg-base-fill-1 flex items-center justify-center rounded-full size-[36px] cursor-pointer hover:bg-base-fill-2">
                    <img src="../public/icons/arrow-left.svg" alt="Назад" class="size-[12px]" />
                  </div>

                  <!-- Page Numbers / Номера страниц -->
                  <div class="flex gap-1 items-center justify-center">
                    <!-- Page 1 (Active) / Страница 1 (Активная) -->
                    <div class="page-button-mobile bg-state-brand-active rounded-full size-[28px] flex items-center justify-center shadow-[0.5px_0.5px_3px_0px_rgba(26,26,26,0.08)]" data-page="1">
                      <p class="text-sm font-semibold text-white leading-[22px]">1</p>
                    </div>

                    <!-- Page 2 / Страница 2 -->
                    <div class="page-button-mobile rounded-full size-[28px] flex items-center justify-center cursor-pointer hover:bg-base-fill-1" data-page="2">
                      <p class="text-sm font-medium text-[rgba(26,26,26,0.36)] leading-[22px]">2</p>
                    </div>

                    <!-- Page 3 / Страница 3 -->
                    <div class="page-button-mobile rounded-full size-[28px] flex items-center justify-center cursor-pointer hover:bg-base-fill-1" data-page="3">
                      <p class="text-sm font-medium text-[rgba(26,26,26,0.36)] leading-[22px]">3</p>
                    </div>

                    <!-- Page 4 / Страница 4 -->
                    <div class="page-button-mobile rounded-full size-[28px] flex items-center justify-center cursor-pointer hover:bg-base-fill-1" data-page="4">
                      <p class="text-sm font-medium text-[rgba(26,26,26,0.36)] leading-[22px]">4</p>
                    </div>

                    <!-- Ellipsis / Многоточие -->
                    <div class="rounded-full size-[28px] flex items-center justify-center">
                      <p class="text-sm font-medium text-[rgba(26,26,26,0.36)] leading-[22px]">...</p>
                    </div>

                    <!-- Page 10 / Страница 10 -->
                    <div class="page-button-mobile rounded-full size-[28px] flex items-center justify-center cursor-pointer hover:bg-base-fill-1" data-page="10">
                      <p class="text-sm font-medium text-[rgba(26,26,26,0.36)] leading-[22px]">10</p>
                    </div>
                  </div>

                  <!-- Next Button / Кнопка "Вперед" -->
                  <div class="next-button-mobile bg-[#fcfcfc] border border-base-border flex items-center justify-center rounded-full size-[36px] cursor-pointer hover:bg-base-fill-1">
                    <img src="../public/icons/arrow-right.svg" alt="Вперед" class="size-[12px]" />
                  </div>
                </div>

                <!-- Rows Per Page / Строк на странице -->
                <div class="flex items-center justify-center gap-2.5">
                  <p class="text-sm-medium text-text-dark-secondary">Показывать</p>
                  <div class="dropdown-container relative">
                    <div class="rows-dropdown-trigger-mobile bg-white border border-base-border flex gap-[6px] h-[36px] items-center pl-[12px] pr-[10px] rounded-full cursor-pointer hover:bg-base-fill-1">
                      <span id="rows-count-text-mobile" class="text-sm-medium text-text-dark-secondary">8 строк</span>
                      <img src="../public/icons/arrow-down.svg" alt="Выпадающий список" class="size-[12px]" />
                    </div>
                    <!-- Dropdown Menu -->
                    <div id="rows-dropdown-menu-mobile" class="dropdown-menu absolute bottom-full left-1/2 -translate-x-1/2 mb-1 bg-white border border-base-border rounded-xl shadow-lg z-50 min-w-[120px] hidden">
                      <div class="py-1">
                        <button class="dropdown-item-mobile w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="8">8 строк</button>
                        <button class="dropdown-item-mobile w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="16">16 строк</button>
                        <button class="dropdown-item-mobile w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="24">24 строки</button>
                        <button class="dropdown-item-mobile w-full text-left pl-5 px-3 py-2 text-sm text-text-dark-secondary hover:bg-base-fill-1" data-value="32">32 строки</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
         
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- JavaScript / Скрипты -->
  <script>
    // Load Components / Загрузка компонентов
    async function loadComponent(containerId, componentPath) {
      try {
        const response = await fetch(componentPath);
        const html = await response.text();
        document.getElementById(containerId).innerHTML = html;
      } catch (error) {
        console.error(`Error loading component ${componentPath}:`, error);
      }
    }

    // Initialize Components / Инициализация компонентов
    document.addEventListener('DOMContentLoaded', async function() {
      await loadComponent('sidebar-container', '../components/sidebar.html');

      // Initialize Grid.js Table / Инициализация таблицы Grid.js
      initDomainsTable();

      // Initialize Mobile Table / Инициализация мобильной таблицы
      initMobileDomainsTable();
    });

    // Global variables for pagination
    let currentPage = 1;
    let rowsPerPage = 8;
    let totalRecords = 0;

    // Update pagination display function
    function updatePaginationDisplay(totalRecords, rowsPerPage) {
      const totalPages = Math.ceil(totalRecords / rowsPerPage);
      const totalCountElement = document.querySelector('.gridjs-pagination p');
      if (totalCountElement) {
        totalCountElement.textContent = `Всего ${totalRecords} доменов`;
      }

      // Update page buttons
      const pageButtons = document.querySelectorAll('.page-button');
      pageButtons.forEach((btn, index) => {
        const pageNum = index + 1;
        if (pageNum <= totalPages) {
          btn.style.display = 'block';
          btn.dataset.page = pageNum;
          btn.querySelector('p').textContent = pageNum;

          // Update active state
          const textElement = btn.querySelector('div');
          if (pageNum === currentPage) {
            btn.classList.remove('text-[rgba(26,26,26,0.36)]');
            btn.classList.add('bg-state-brand-active', 'text-white');
            if (textElement) {
              textElement.classList.remove('text-[rgba(26,26,26,0.36)]');
              textElement.classList.add('text-white');
            }
          } else {
            btn.classList.remove('bg-state-brand-active', 'text-white');
            btn.classList.add('text-[rgba(26,26,26,0.36)]');
            if (textElement) {
              textElement.classList.remove('text-white');
              textElement.classList.add('text-[rgba(26,26,26,0.36)]');
            }
          }
        } else {
          btn.style.display = 'none';
        }
      });

      // Hide ellipsis and last page if not needed
      const ellipsis = document.querySelector('.gridjs-pagination .overflow-clip');
      const lastPage = document.querySelector('.page-button[data-page="10"]');
      if (totalPages <= 4) {
        if (ellipsis) ellipsis.style.display = 'none';
        if (lastPage) lastPage.style.display = 'none';
      }
    }


    // Initialize Domains Table / Инициализация таблицы доменов
    function initDomainsTable() {
      // Sample data / Примеры данных
      const domainsData = [
        {
          domain: 'testdomain.com',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: '<div class="flex items-center gap-2"><span class="text-text-dark-secondary text-sm-medium overflow-ellipsis overflow-hidden">sullivan.ns.cloudfraler.com</span><div class="bg-base-fill-1 h-6 px-2 py-0 rounded-6 border border-base-border shadow-xs flex items-center"><span class="text-xs-medium text-text-dark-secondary">+3</span></div></div>',
          expiry: '12.02.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'megatest.com',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.com',
          expiry: '08.03.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'bobadsdasdsadasdsd.com',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: 'sullivan.ns.cloudfraler.com',
          expiry: '21.02.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'portfolio.dev',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: 'sullivan.ns.cloudfraler.come',
          expiry: '21.02.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'megatest.com',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.come',
          expiry: '08.03.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'blog.net',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: '<div class="flex items-center gap-2"><span class="text-text-dark-secondary text-sm-medium overflow-ellipsis overflow-hidden">sullivan.ns.cloudfraler.come</span><div class="bg-base-fill-1 h-6 px-2 py-0 rounded-6 border border-base-border shadow-xs flex items-center"><span class="text-xs-medium text-text-dark-secondary">+2</span></div></div>',
          expiry: '21.02.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'epic.com',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.come',
          expiry: '14.04.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'store.pro',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.come',
          expiry: '14.05.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'mywebsite.com',
          owner: 'Иван К.',
          dns: 'ns1.hostinger.com',
          expiry: '25.06.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'business-solution.ru',
          owner: 'ООО "Технологические решения"',
          dns: 'ns2.reg.ru',
          expiry: '15.08.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'portfolio-site.dev',
          owner: 'Мария С.',
          dns: 'ns1.cloudflare.com',
          expiry: '30.09.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'shop-online.store',
          owner: 'ИП Петров А.В.',
          dns: '<div class="flex items-center gap-2"><span class="text-text-dark-secondary text-sm-medium overflow-ellipsis overflow-hidden">ns1.beget.com</span><div class="bg-base-fill-1 h-6 px-2 py-0 rounded-6 border border-base-border shadow-xs flex items-center"><span class="text-xs-medium text-text-dark-secondary">+5</span></div></div>',
          expiry: '12.11.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'travel-agency.com',
          owner: 'Туристическое агентство "Мечта"',
          dns: 'ns1.timeweb.ru',
          expiry: '05.12.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'food-delivery.app',
          owner: 'Служба доставки еды',
          dns: 'ns1.reg.ru',
          expiry: '18.01.2026',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'education-center.org',
          owner: 'Центр образования "Знание"',
          dns: 'ns2.hosting.ru',
          expiry: '22.02.2026',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'fitness-club.gym',
          owner: 'Фитнес-клуб "Энергия"',
          dns: 'ns1.hostland.ru',
          expiry: '07.03.2026',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'medical-clinic.health',
          owner: 'Медицинский центр "Здоровье"',
          dns: 'ns1.nic.ru',
          expiry: '19.04.2026',
          autoRenewal: true,
          actions: ''
        }
      ];

      // Manual pagination - we'll handle data slicing ourselves
      let currentData = domainsData;
      const initialPageData = currentData.slice(0, rowsPerPage).map(row => [
        null, // checkbox
        row.domain,
        row.owner,
        row.dns,
        row.expiry,
        row.autoRenewal,
        row.actions
      ]);

      const grid = new gridjs.Grid({
        pagination: false, // Disable built-in pagination
        columns: [
          {
            name: gridjs.html(`<input type="checkbox" id="select-all-checkbox" class="header-checkbox w-[22px] h-[22px] text-state-brand-active bg-white border-2 border-base-border rounded-3 focus:ring-state-brand-active focus:ring-2 shadow-xs">`),
            id: 'checkbox',
            formatter: (cell, row) => {
              const checkboxId = `checkbox-${row.cells[1].data}`;
              return gridjs.html(`<input type="checkbox" id="${checkboxId}" class="row-checkbox w-[22px] h-[22px] text-state-brand-active bg-white border-2 border-base-border rounded-3 focus:ring-state-brand-active focus:ring-2 shadow-xs">`);
            },
            width: '60px',
            sort: false
          },
          {
            name: 'Имя домена',
            id: 'domain',
            width: 'auto',
            sort: false
          },
          {
            name: 'Владелец',
            id: 'owner',
            formatter: (cell) => gridjs.html(`<div style="overflow: hidden; display: flex; align-items: center;">${cell}</div>`),
            width: 'auto',
            sort: false
          },
          {
            name: 'DNS',
            id: 'dns',
            formatter: (cell) => gridjs.html(`<div style="overflow: hidden; display: flex; align-items: center;">${cell}</div>`),
            width: 'auto',
            sort: false
          },
          {
            name: 'Оплачен до',
            id: 'expiry',
            width: '160px',
            sort: {
              compare: (a, b) => {
                // Custom sort function for dates
                const dateA = new Date(a.split('.').reverse().join('-'));
                const dateB = new Date(b.split('.').reverse().join('-'));
                return dateA - dateB;
              }
            }
          },
          {
            name: 'Автопродление',
            id: 'autoRenewal',
            formatter: (cell, row) => {
              const toggleId = `toggle-${row.cells[1].data}`;
              const isChecked = row.cells[5].data;
              return gridjs.html(`
                <div class="flex items-center justify-center">
                  <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="${toggleId}" class="sr-only peer" ${isChecked ? 'checked' : ''}>
                    <div class="toggle-switch w-15 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-state-brand-active rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:left-[1px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-state-brand-active"></div>
                  </label>
                </div>
              `);
            },
            width: '178px',
            sort: false
          },
          {
            name: '',
            id: 'actions',
            formatter: (cell) => gridjs.html(`<div class="flex items-center justify-center"><button class="p-1 hover:bg-base-fill-1 rounded"><img src="../public/icons/more-vertical.svg" alt="Действия" class="w-4 h-4" /></button></div>`),
            width: '60px',
            sort: false
          }
        ],
        data: initialPageData,
        search: false,
        sort: false,
        resizable: false,
        footer: false,
        style: {
          footer: {
            display: 'none',
            height: '0',
            overflow: 'hidden'
          }
        },
        className: {
          table: 'gridjs-table-figma',
          th: 'gridjs-th-figma',
          td: 'gridjs-td-figma gridjs-td-clickable',
          container: 'gridjs-container-figma',
          pagination: 'gridjs-pagination-figma',
          footer: 'hidden'
        }
      }).render(document.getElementById('domains-table'));

      // Function to update table body without re-rendering header
      function updateTableBody(data) {
        const tbody = document.querySelector('#domains-table .gridjs-tbody');
        if (!tbody) return;

        tbody.classList.add('transitioning');

        setTimeout(() => {
          let rowsHTML = '';
          data.forEach((row, index) => {
            const checkboxId = `checkbox-${row.domain}`;
            const toggleId = `toggle-${row.domain}`;
            const isChecked = row.autoRenewal ? 'checked' : '';

            rowsHTML += `
              <tr class="gridjs-tr">
                <td class="gridjs-td gridjs-td-figma gridjs-td-clickable">
                  <input type="checkbox" id="${checkboxId}" class="row-checkbox w-[22px] h-[22px] text-state-brand-active bg-white border-2 border-base-border rounded-3 focus:ring-state-brand-active focus:ring-2 shadow-xs">
                </td>
                <td class="gridjs-td gridjs-td-figma gridjs-td-clickable">${row.domain}</td>
                <td class="gridjs-td gridjs-td-figma gridjs-td-clickable"><div style="overflow: hidden; display: flex; align-items: center;">${row.owner}</div></td>
                <td class="gridjs-td gridjs-td-figma gridjs-td-clickable"><div style="overflow: hidden; display: flex; align-items: center;">${row.dns}</div></td>
                <td class="gridjs-td gridjs-td-figma gridjs-td-clickable">${row.expiry}</td>
                <td class="gridjs-td gridjs-td-figma gridjs-td-clickable">
                  <div class="flex items-center justify-center">
                    <label class="relative inline-flex items-center cursor-pointer">
                      <input type="checkbox" id="${toggleId}" class="sr-only peer" ${isChecked}>
                      <div class="toggle-switch w-15 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-state-brand-active rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:left-[1px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-state-brand-active"></div>
                    </label>
                  </div>
                </td>
                <td class="gridjs-td gridjs-td-figma gridjs-td-clickable">
                  <div class="flex items-center justify-center"><button class="p-1 hover:bg-base-fill-1 rounded"><img src="../public/icons/more-vertical.svg" alt="Действия" class="w-4 h-4" /></button></div>
                </td>
              </tr>
            `;
          });

          tbody.innerHTML = rowsHTML;

          setTimeout(() => {
            tbody.classList.remove('transitioning');
            initCheckboxes();
          }, 50);
        }, 120);
      }

      // Add click handler for table rows to navigate to domain settings
      document.addEventListener('click', (e) => {
        // Check if click is on a table cell
        const cell = e.target.closest('.gridjs-td-figma');
        if (cell) {
          // Exclude clicks on checkboxes, toggles, action buttons, and their containers
          if (
            e.target.closest('input[type="checkbox"]') ||
            e.target.closest('.toggle-switch') ||
            e.target.closest('button') ||
            e.target.closest('label')
          ) {
            return; // Don't navigate if clicking on interactive elements
          }

          // Get the row
          const row = cell.closest('tr');
          if (row) {
            // Navigate to domain settings page
            window.location.href = './domain-settings.html';
          }
        }
      });

      // Set total records and update pagination
      totalRecords = domainsData.length;
      updatePaginationDisplay(totalRecords, rowsPerPage);

      // Function to initialize checkboxes after table render
      function initCheckboxes() {
        const selectAllCheckbox = document.getElementById('select-all-checkbox');
        if (selectAllCheckbox) {
          // Remove existing listener if any
          const newSelectAll = selectAllCheckbox.cloneNode(true);
          selectAllCheckbox.parentNode.replaceChild(newSelectAll, selectAllCheckbox);

          newSelectAll.addEventListener('change', (e) => {
            const isChecked = e.target.checked;
            const rowCheckboxes = document.querySelectorAll('.row-checkbox');
            rowCheckboxes.forEach(checkbox => {
              checkbox.checked = isChecked;
            });
            console.log(isChecked ? 'Selected all rows' : 'Deselected all rows');
          });
        }
      }

      // Handle individual row checkboxes using event delegation
      document.addEventListener('change', (e) => {
        if (e.target.classList.contains('row-checkbox')) {
          const rowCheckboxes = document.querySelectorAll('.row-checkbox');
          const checkedBoxes = document.querySelectorAll('.row-checkbox:checked');
          const selectAllCheckbox = document.getElementById('select-all-checkbox');

          // Update select all checkbox state
          if (selectAllCheckbox) {
            if (checkedBoxes.length === 0) {
              selectAllCheckbox.checked = false;
              selectAllCheckbox.indeterminate = false;
            } else if (checkedBoxes.length === rowCheckboxes.length) {
              selectAllCheckbox.checked = true;
              selectAllCheckbox.indeterminate = false;
            } else {
              selectAllCheckbox.checked = false;
              selectAllCheckbox.indeterminate = true;
            }
          }

          console.log(`Selected ${checkedBoxes.length} of ${rowCheckboxes.length} rows`);
        }
      });

      // Initialize checkboxes after first render
      setTimeout(() => initCheckboxes(), 100);


      // Connect search input to Grid.js search
      const searchInput = document.getElementById('domain-search');
      if (searchInput) {
        searchInput.addEventListener('input', (e) => {
          const searchTerm = e.target.value.toLowerCase();
          let filteredData = domainsData;
          if (searchTerm !== '') {
            // Filter data based on search term
            filteredData = domainsData.filter(row =>
              row.domain.toLowerCase().includes(searchTerm) ||
              row.owner.toLowerCase().includes(searchTerm)
            );
          }
          // Update current data
          currentData = filteredData;
          totalRecords = currentData.length;
          currentPage = 1;

          // Update table with first page of filtered data
          const pageData = currentData.slice(0, rowsPerPage);

          updatePaginationDisplay(totalRecords, rowsPerPage);
          updateTableBody(pageData);
        });
      }

      // Handle toggle switches for auto-renewal
      document.addEventListener('change', (e) => {
        if (e.target.matches('[id^="toggle-"]')) {
          const toggleId = e.target.id;
          const domainName = toggleId.replace('toggle-', '');
          const isChecked = e.target.checked;

          console.log(`Toggle for ${domainName}: ${isChecked ? 'ON' : 'OFF'}`);
          // Here you would typically send an API request to update the auto-renewal status
        }
      });

        // Handle pagination clicks
        document.addEventListener('click', (e) => {
          // Handle direct page navigation
          if (e.target.closest('.page-button')) {
            const pageButton = e.target.closest('.page-button');
            currentPage = parseInt(pageButton.dataset.page);

            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const pageData = currentData.slice(start, end);

            updatePaginationDisplay(totalRecords, rowsPerPage);
            updateTableBody(pageData);

            console.log(`Navigate to page ${currentPage}`);
          }

          if (e.target.closest('.prev-button')) {
            if (currentPage > 1) {
              currentPage--;

              const start = (currentPage - 1) * rowsPerPage;
              const end = start + rowsPerPage;
              const pageData = currentData.slice(start, end);

              updatePaginationDisplay(totalRecords, rowsPerPage);
              updateTableBody(pageData);
            }
            console.log('Navigate to previous page');
          }

          if (e.target.closest('.next-button')) {
            const totalPages = Math.ceil(totalRecords / rowsPerPage);
            if (currentPage < totalPages) {
              currentPage++;

              const start = (currentPage - 1) * rowsPerPage;
              const end = start + rowsPerPage;
              const pageData = currentData.slice(start, end);

              updatePaginationDisplay(totalRecords, rowsPerPage);
              updateTableBody(pageData);
            }
            console.log('Navigate to next page');
          }

          // Handle row count dropdown trigger
          if (e.target.closest('.rows-dropdown-trigger')) {
            const menu = document.getElementById('rows-dropdown-menu');
            menu.classList.toggle('hidden');
          }

          // Handle dropdown item selection
          if (e.target.classList.contains('dropdown-item')) {
            const value = e.target.dataset.value;
            const text = e.target.textContent;
            document.getElementById('rows-count-text').textContent = text;

            // Hide dropdown
            document.getElementById('rows-dropdown-menu').classList.add('hidden');

            // Update global variables
            const newLimit = parseInt(value);
            rowsPerPage = newLimit;
            currentPage = 1; // Reset to first page

            // Update table with new page size
            const pageData = currentData.slice(0, rowsPerPage);

            updatePaginationDisplay(totalRecords, rowsPerPage);
            updateTableBody(pageData);

            console.log(`Changed rows per page to ${newLimit}`);
          }

          // Close dropdown when clicking outside
          if (!e.target.closest('.dropdown-container')) {
            document.getElementById('rows-dropdown-menu').classList.add('hidden');
          }
        });

    }

    // Initialize Mobile Domains Table / Инициализация мобильной таблицы доменов
    function initMobileDomainsTable() {
      // Sample data - same as desktop / Те же данные что и для десктопа
      const domainsData = [
        {
          domain: 'testdomain.com',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: 'sullivan.ns.cloudfraler.com',
          dnsExtra: '+3',
          expiry: '12.02.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'megatest.com',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.com',
          dnsExtra: null,
          expiry: '08.03.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'bobadsdasdsadasdsd.com',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: 'sullivan.ns.cloudfraler.com',
          dnsExtra: null,
          expiry: '21.02.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'portfolio.dev',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: 'sullivan.ns.cloudfraler.come',
          dnsExtra: null,
          expiry: '21.02.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'megatest.com',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.come',
          dnsExtra: null,
          expiry: '08.03.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'blog.net',
          owner: 'Общество с Ограниченной Ответственностью Ромашка',
          dns: 'sullivan.ns.cloudfraler.come',
          dnsExtra: '+2',
          expiry: '21.02.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'epic.com',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.come',
          dnsExtra: null,
          expiry: '14.04.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'store.pro',
          owner: 'Александр М.',
          dns: 'sullivan.ns.cloudfraler.come',
          dnsExtra: null,
          expiry: '14.05.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'mywebsite.com',
          owner: 'Иван К.',
          dns: 'ns1.hostinger.com',
          dnsExtra: null,
          expiry: '25.06.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'business-solution.ru',
          owner: 'ООО "Технологические решения"',
          dns: 'ns2.reg.ru',
          dnsExtra: null,
          expiry: '15.08.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'portfolio-site.dev',
          owner: 'Мария С.',
          dns: 'ns1.cloudflare.com',
          dnsExtra: null,
          expiry: '30.09.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'shop-online.store',
          owner: 'ИП Петров А.В.',
          dns: 'ns1.beget.com',
          dnsExtra: '+5',
          expiry: '12.11.2025',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'travel-agency.com',
          owner: 'Туристическое агентство "Мечта"',
          dns: 'ns1.timeweb.ru',
          dnsExtra: null,
          expiry: '05.12.2025',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'food-delivery.app',
          owner: 'Служба доставки еды',
          dns: 'ns1.reg.ru',
          dnsExtra: null,
          expiry: '18.01.2026',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'education-center.org',
          owner: 'Центр образования "Знание"',
          dns: 'ns2.hosting.ru',
          dnsExtra: null,
          expiry: '22.02.2026',
          autoRenewal: false,
          actions: ''
        },
        {
          domain: 'fitness-club.gym',
          owner: 'Фитнес-клуб "Энергия"',
          dns: 'ns1.hostland.ru',
          dnsExtra: null,
          expiry: '07.03.2026',
          autoRenewal: true,
          actions: ''
        },
        {
          domain: 'medical-clinic.health',
          owner: 'Медицинский центр "Здоровье"',
          dns: 'ns1.nic.ru',
          dnsExtra: null,
          expiry: '19.04.2026',
          autoRenewal: true,
          actions: ''
        }
      ];

      let currentMobileData = domainsData;

      // Function to render mobile table rows
      function renderMobileTable(data, startIndex, limit) {
        const container = document.getElementById('domains-table-mobile');
        const endIndex = Math.min(startIndex + limit, data.length);
        const pageData = data.slice(startIndex, endIndex);

        let html = '';

        // Add header row with select-all checkbox
        html += `
          <div class="bg-base-surface-2 border-b border-base-border flex items-center px-4 py-3">
            <div class="flex items-center gap-4 w-full">
              <input type="checkbox" id="select-all-checkbox-mobile" class="header-checkbox w-[22px] h-[22px] text-state-brand-active bg-white border-2 border-base-border rounded-3 focus:ring-state-brand-active focus:ring-2 shadow-xs">
              <span class="text-base font-medium text-text-dark-secondary">Выбрать все</span>
            </div>
          </div>
        `;

        // Add data rows
        pageData.forEach((row, index) => {
          const rowId = `mobile-row-${startIndex + index}`;
          const checkboxId = `mobile-checkbox-${row.domain}`;
          const dnsDisplay = row.dnsExtra
            ? `<div class="flex items-center gap-2">
                <span class="text-sm-medium text-text-dark-secondary overflow-ellipsis overflow-hidden">${row.dns}</span>
                <div class="bg-base-fill-1 h-6 px-2 py-0 rounded-6 border border-base-border shadow-xs flex items-center">
                  <span class="text-xs-medium text-text-dark-secondary">${row.dnsExtra}</span>
                </div>
              </div>`
            : `<span class="text-sm-medium text-text-dark-secondary">${row.dns}</span>`;

          html += `
            <div id="${rowId}" class="bg-white border-b border-base-border last:border-b-0 flex items-start px-4 py-4 hover:bg-base-surface-2 transition-colors cursor-pointer mobile-domain-row">
              <!-- Checkbox Column / Колонка с чекбоксом -->
              <div class="flex items-center justify-center pt-1 pr-4">
                <input type="checkbox" id="${checkboxId}" class="row-checkbox-mobile w-[22px] h-[22px] text-state-brand-active bg-white border-2 border-base-border rounded-3 focus:ring-state-brand-active focus:ring-2 shadow-xs">
              </div>

              <!-- Info Column / Информационная колонка -->
              <div class="flex flex-col gap-3 flex-1 min-w-0">
                <!-- Domain Name / Имя домена -->
                <div class="flex items-center justify-between">
                  <h3 class="text-base font-semibold text-text-dark-primary overflow-ellipsis overflow-hidden">${row.domain}</h3>
                  <button class="p-1 hover:bg-base-fill-1 rounded flex-shrink-0">
                    <img src="../public/icons/more-vertical.svg" alt="Действия" class="w-4 h-4" />
                  </button>
                </div>

                <!-- Expiry Date / Дата оплаты -->
                <div class="flex items-start gap-2">
                  <span class="text-sm-medium text-text-dark-secondary whitespace-nowrap">Оплачен до:</span>
                  <span class="text-sm-medium text-text-dark-primary">${row.expiry}</span>
                </div>

                <!-- DNS / DNS -->
                <div class="flex items-start gap-2">
                  <span class="text-sm-medium text-text-dark-secondary whitespace-nowrap">DNS:</span>
                  <div class="min-w-0 flex-1">
                    ${dnsDisplay}
                  </div>
                </div>
              </div>
            </div>
          `;
        });

        container.innerHTML = html;

        // Add event listeners for checkboxes
        setTimeout(() => {
          const selectAllMobile = document.getElementById('select-all-checkbox-mobile');
          if (selectAllMobile) {
            selectAllMobile.addEventListener('change', (e) => {
              const isChecked = e.target.checked;
              const rowCheckboxes = document.querySelectorAll('.row-checkbox-mobile');
              rowCheckboxes.forEach(checkbox => {
                checkbox.checked = isChecked;
              });
            });
          }

          // Handle individual row checkboxes
          document.addEventListener('change', (e) => {
            if (e.target.classList.contains('row-checkbox-mobile')) {
              const rowCheckboxes = document.querySelectorAll('.row-checkbox-mobile');
              const checkedBoxes = document.querySelectorAll('.row-checkbox-mobile:checked');
              const selectAllMobile = document.getElementById('select-all-checkbox-mobile');

              if (selectAllMobile) {
                if (checkedBoxes.length === 0) {
                  selectAllMobile.checked = false;
                  selectAllMobile.indeterminate = false;
                } else if (checkedBoxes.length === rowCheckboxes.length) {
                  selectAllMobile.checked = true;
                  selectAllMobile.indeterminate = false;
                } else {
                  selectAllMobile.checked = false;
                  selectAllMobile.indeterminate = true;
                }
              }
            }
          });
        }, 100);
      }

      // Initial render
      renderMobileTable(currentMobileData, 0, rowsPerPage);

      // Connect search to mobile table
      const searchInput = document.getElementById('domain-search');
      if (searchInput) {
        searchInput.addEventListener('input', (e) => {
          const searchTerm = e.target.value.toLowerCase();
          let filteredData = domainsData;
          if (searchTerm !== '') {
            filteredData = domainsData.filter(row =>
              row.domain.toLowerCase().includes(searchTerm) ||
              row.owner.toLowerCase().includes(searchTerm)
            );
          }
          currentMobileData = filteredData;
          renderMobileTable(currentMobileData, 0, rowsPerPage);
        });
      }

      // Handle mobile pagination clicks
      document.addEventListener('click', (e) => {
        // Handle mobile page buttons
        if (e.target.closest('.page-button-mobile')) {
          const pageButton = e.target.closest('.page-button-mobile');
          const page = parseInt(pageButton.dataset.page);
          const start = (page - 1) * rowsPerPage;
          renderMobileTable(currentMobileData, start, rowsPerPage);
        }

        // Handle mobile prev button
        if (e.target.closest('.prev-button-mobile')) {
          if (currentPage > 1) {
            const start = (currentPage - 2) * rowsPerPage;
            renderMobileTable(currentMobileData, start, rowsPerPage);
          }
        }

        // Handle mobile next button
        if (e.target.closest('.next-button-mobile')) {
          const totalPages = Math.ceil(currentMobileData.length / rowsPerPage);
          if (currentPage < totalPages) {
            const start = currentPage * rowsPerPage;
            renderMobileTable(currentMobileData, start, rowsPerPage);
          }
        }

        // Handle mobile dropdown
        if (e.target.closest('.rows-dropdown-trigger-mobile')) {
          const menu = document.getElementById('rows-dropdown-menu-mobile');
          menu.classList.toggle('hidden');
        }

        // Handle mobile dropdown item selection
        if (e.target.classList.contains('dropdown-item-mobile')) {
          const value = e.target.dataset.value;
          const text = e.target.textContent;
          document.getElementById('rows-count-text-mobile').textContent = text;
          document.getElementById('rows-dropdown-menu-mobile').classList.add('hidden');

          const newLimit = parseInt(value);
          rowsPerPage = newLimit;
          currentPage = 1;

          renderMobileTable(currentMobileData, 0, rowsPerPage);
        }

        // Handle mobile row clicks to navigate to domain settings
        if (e.target.closest('.mobile-domain-row')) {
          // Exclude clicks on checkboxes and action buttons
          if (
            e.target.closest('input[type="checkbox"]') ||
            e.target.closest('button')
          ) {
            return; // Don't navigate if clicking on interactive elements
          }

          const row = e.target.closest('.mobile-domain-row');
          if (row) {
            window.location.href = './domain-settings.html';
          }
        }
      });
    }

  </script>
</body>
</html>